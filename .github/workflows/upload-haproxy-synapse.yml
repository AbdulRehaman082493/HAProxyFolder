name: Upload HAProxy files for Synapse

on:
  workflow_dispatch:
    inputs:
      environment:
        description: "Select environment"
        type: choice
        required: true
        options:
          - dev
          - test
          - test-ussc
          - stage
          - prod
          - prod-ussc
        default: dev

jobs:
  upload-haproxy:
    # Reuse the workflow from this SAME repo
    uses: ./.github/workflows/upload-haproxy-files.yml
    with:
      environment: ${{ inputs.environment }}

      # === config file upload ===
      # TODO: replace these with your real values
      config-storage-account: your-config-storage-account
      config-container-name: your-config-container
      config-file-path: haproxy/haproxy.cfg.${{ inputs.environment }}
      config-blob-name: haproxy.cfg.${{ inputs.environment }}

      # === script file upload ===
      script-storage-account: your-script-storage-account
      script-container-name: your-script-container
      script-file-path: haproxy/scripts/install-haproxy.sh
      script-blob-name: install-haproxy.sh

    secrets:
      AZURE_CREDENTIALS: ${{ secrets.AZURE_CREDENTIALS }}
